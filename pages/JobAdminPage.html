<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="keywords" content="Lotus, Education, CA, Engineering, Coaching, Lotuseduservices, gateforum">
        <meta name="description" content="PG, UG, CA Engineering Eduction and Coaching">
        <meta name="author" content="Aashutosh Prakash">

        <title>Admin Page</title>

        <!-- Bootstrap Core CSS -->
        <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>
        <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Kanit:500" rel="stylesheet">


        <!-- Theme CSS -->
        <link href="../css/supportpage.css" rel="stylesheet">

    </head>

    <body id="page-top" class="index main">

    <!-- Navigation -->
    <nav id="mainNav" class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand page-scroll" href="../index.html"><img src="../img/logos/logo.png" alt="SahajWorldLogo" class="img-responsive img-thumbnail"></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
					<li>
                        <a class="page-scroll" href="../pages/JobPage.html">Search Jobs</a>
                    </li>
					<li>
                        <a class="page-scroll" href="https://docs.google.com/forms/d/e/1FAIpQLSeNNOxSFBbZg8HU5WV5Ary3SiEU7zz7G6tCVyXqTlO_Kajmwg/viewform" target="_blank">Post Jobs</a>
                    </li>
					<li>
                        <a class="page-scroll" href="https://docs.google.com/forms/d/e/1FAIpQLSdqWUmhGS0JhqxKu6MZBmOSVAYF4Vs4Thc5BcIpOClrkTbV4g/viewform" target="_blank">Search Property</a>
                    </li>
					<li>
                        <a class="page-scroll" href="https://docs.google.com/forms/d/e/1FAIpQLSc3x4WL8nE2EcCrFYFaEaxvL8oQzqmxTGzdk4rd6IxFx-dJSw/viewform" target="_blank">Post Property</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#services">Services</a>
                    </li>

                    <!--<li>
                        <a class="page-scroll" href="#portfolio">Portfolio</a>
                    </li>-->
                    <!--<li>
                        <a class="page-scroll" href="#about">About</a>
                    </li>-->
                    <!--<li>
                        <a class="page-scroll" href="#team">Team</a>
                    </li>-->
                    <li>
                        <a class="page-scroll" href="#contact">Contact</a>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle page-scroll" data-toggle="dropdown" href="#" style="border-radius:3px">Menu <span class="caret"></span></a>
                        <ul class="dropdown-menu page-scroll" role="menu" style="background-color: #222">
                            <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSfZUB7dY_yhR4qwDRYMQYFeBpdyl5OBM2gVUzQlL5NJ_Ts7zw/viewform" target="_blank">Apply PAN</a></li>
                            <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSfZUB7dY_yhR4qwDRYMQYFeBpdyl5OBM2gVUzQlL5NJ_Ts7zw/viewform" target="_blank">Apply Passport</a></li>
							<li><a href="https://docs.google.com/forms/d/e/1FAIpQLSfZUB7dY_yhR4qwDRYMQYFeBpdyl5OBM2gVUzQlL5NJ_Ts7zw/viewform" target="_blank">Apply Voter-ID</a></li>
                            <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSfDzJI96lumU5R_p6YbHWipdRJZwrnXPhjsK1CT_ZZgzZKHuA/viewform" target="_blank">Insurance</a></li>
                            <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSd69z8X9tg0LXzQz6UumgbBEbR4lZHkMGBHB1SwrGoDARgoEA/viewform" target="_blank">Rail E-tickets</a></li>
							<li><a href="https://docs.google.com/forms/d/e/1FAIpQLSeBpS7m91WPlXRtwF0tCzs6o8u1_dKkQY0BMsSxZ1VXZPIjmA/viewform" target="_blank">Affidavit</a></li>
							<li><a href="https://docs.google.com/forms/d/e/1FAIpQLSeBpS7m91WPlXRtwF0tCzs6o8u1_dKkQY0BMsSxZ1VXZPIjmA/viewform" target="_blank">Contratual Agreements</a></li>
							<li><a href="https://docs.google.com/forms/d/e/1FAIpQLSeBpS7m91WPlXRtwF0tCzs6o8u1_dKkQY0BMsSxZ1VXZPIjmA/viewform" target="_blank">Certificates</a></li>
                        </ul>
                    </li>
                    <li>
                        <!--<a class="page-scroll portfolio-link" href="#portfolioModal2" style="background-color:#f4511e;border-color:#fed136;border-radius:3px" data-toggle="modal">Register</a> -->
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
        <section class="bg-light-gray narrow" style="padding-bottom:0;">
            <div class="container">
            <div class="padder"></div></div>
            <div style="margin-bottom:15px;"><text style="font-size:37px; padding-left:50px;" class="job-title">Admin Page<text></div>

            <div style="padding-left:50px;">
              <text style="font-size:18px;" class="job-title">Post new job:<text>
              <input type="text" class="form-control ui-autocomplete-input" id="title" placeholder="Title" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="company_name" placeholder="Company name" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="address" placeholder="Company address" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="experience" placeholder="Experience range, Eg: '3-6 years'" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="salary" placeholder="Salary range, Eg: '8-13 LPA'" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="number_of_openings" placeholder="Number of openings, Eg: '25'" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="job_type" placeholder="Job Type, Eg; 'Full time', 'Part time'" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control long ui-autocomplete-input" id="qualifications" placeholder="Qualifications required" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control long ui-autocomplete-input" id="skills" placeholder="Skills required" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control long ui-autocomplete-input" id="documents" placeholder="Documents required" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control long ui-autocomplete-input" id="description" placeholder="Description" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="date" placeholder="Date and Time" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="contact" placeholder="Contact, Eg: 'Sunil - 9659276502, Ritesh - 98234829132'" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <input type="text" class="form-control ui-autocomplete-input" id="email" placeholder="Email" onfocus="if(this.value==&quot;&quot;)this.value=&quot;&quot;" onblur="if(this.value=='')this.value=''" autocomplete="on">
              <button id="post_new_job" class="bttn apply">Post new job</button>
          </div>
            <div id="loading" class="loading"><text>Loading jobs...<text></div>
		    </section>

        <div class="scrollable" id="query_view">
          <div id="query_loading" class="loading"><text>Waiting for authentication...<text></div>
        </div>

        <section class="job_list" id="job_list"></section>

        <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <span class="copyright">Copyright &copy; 2018 Sahaj World Enterprises</span>
                </div>
                <div class="col-md-4">
                    <ul class="list-inline social-buttons">
                        <li><a href="https://twitter.com/SahajWorld?s=03" target="_blank"><i class="fa fa-twitter"></i></a>
                        </li>
                        <li><a href="https://facebook.com/SahajWorld/?ref=bookmarks" target="_blank"><i class="fa fa-facebook"></i></a>
                        </li>
                        <li><a href="https://www.linkedin.com/in/sahaj-enterprises-3a164215b" target="_blank"><i class="fa fa-linkedin"></i></a>
                        </li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <ul class="list-inline quicklinks" >
                        <li>Developed and maintained by : <a style="color:blue"	href="https://www.facebook.com/ansh.ferrari" target="_blank">Ansh Dedha</a>
                        </li>
                        <li><a style="color:blue" href="https://www.facebook.com/pandeyharshvardhan400" target="_blank"> Harsh Vardhan Pandey</a>
                        <li><a style="color:blue" href="https://www.facebook.com/aashu987" target="_blank">Aashutosh Prakash </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        </div>
    </footer>


         <!-- jQuery -->
        <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>


        <!-- Theme JavaScript -->
    <script src="../js/agency.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/4.11.0/firebase.js"></script>
    <script>

      var url = new URL(window.location.href);
      var data = url.searchParams.get("data");
      if(data!="updated"){
        askPassword();
      }

      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyBB09k3H31LSSSOro3IEhucquJz7Jq_VA0",
        authDomain: "sahaj-world-1.firebaseapp.com",
        databaseURL: "https://sahaj-world-1.firebaseio.com",
        projectId: "sahaj-world-1",
        storageBucket: "",
        messagingSenderId: "828268800924"
      };
      firebase.initializeApp(config);

      var lineDiv = document.createElement('div');
      lineDiv.className = "line-div";

  	  var jobRef = firebase.database().ref().child('Jobs');
      var enquiryRef = firebase.database().ref().child('Enquiries');

      $('#post_new_job').click(function(){
        if($('#title').val()!=""&&$('#company_name').val()!=""){
          var newjobRef = jobRef.child(guid());
          newjobRef.set({
            Title:$('#title').val(),
            CompanyName:$('#company_name').val(),
            Address:$('#address').val(),
            Experience:$('#experience').val(),
            Salary:$('#salary').val(),
            Openings:$('#number_of_openings').val(),
            JobType:$('#job_type').val(),
            Qualifications:$('#qualifications').val(),
            Skills:$('#skills').val(),
            DocumentsRequired:$('#documents').val(),
            Description:$('#description').val(),
            DateTime:$('#date').val(),
            Contact:$('#contact').val(),
            Email:$('#email').val(),
            timestamp:Date.now(),
          });
          refresh();
        }else{
          window.alert("Title and Company name cannot be blank.");
        }

      });

      enquiryRef.orderByChild('timestamp').once("value", function(snapshot) {
        var div = document.getElementById('query_view');
    		snapshot.forEach(function(child) {
      		var iDiv = document.createElement('div');
      		iDiv.id = child.key;
          iDiv.className = "query-div";
      		iDiv.innerHTML = "<div class=\"position-title header-text inline-block-div\"><text class=\"job-title\">"
      		  +child.child("Name").val()
      		  +"<text></div>"
      			+printListItem("Email: ", child.child("Email").val())
            +printListItem("Phone: ", child.child("Phone").val())
            +printListItem("Message: ", child.child("Message").val())
            +printListItem("Date: ", new Date (child.child("timestamp").val()))
            +"</ul>"
            +renderReadButton(child.child("timestamp").val(), child.key, child.child("Name").val(),child.child("Email").val(),child.child("Phone").val(),child.child("Message").val())
            +"<button id=\"delete_post\" onclick=\"deletePost('"+child.key+"')\" class=\"bttn delete read apply\" style=\"margin-left:10px;\">Delete</button>";
			+"<div class=\"long-line-div\"></div>"

          div.insertBefore(iDiv, div.firstChild);
    		});
        var heading_div = document.createElement('div');
        heading_div.className = "query-div";
        heading_div.innerHTML = "<text style=\"font-size:24px; font-weight:400;\" class=\"job-title\">Queries from customers:<text>";
        div.insertBefore(heading_div, div.firstChild);
        document.getElementById("query_loading").style.display = "none";
  	  });

  	  jobRef.orderByChild('timestamp').once("value", function(snapshot) {
    		snapshot.forEach(function(child) {
      		var iDiv = document.createElement('div');
      		iDiv.id = child.key;
          iDiv.className = "job-div";
      		iDiv.innerHTML = "<div class=\"position-title header-text inline-block-div\"><text class=\"job-title\">"
      		  +child.child("Title").val()
      		  +"<text></div>"
            +"<h5 class=\"company-name\"><span>"
      		  +child.child("CompanyName").val()
      		  +"</span></h5>"
            +"<ul class=\"list-unstyled\"><li class=\"job-location\"><i class=\"icon icon-location\"></i><span>"
            +printValidatedValue(child.child("Address").val())
            +"</span></li>"
      			+"<li class=\"details\"><i class=\"icon icon-dollar-sign\"></i>"
            +printValidatedValue(child.child("Experience").val())
            +printValidatedTag(child.child("Salary").val())
            +getNumberOfOpenings(child.child("Openings").val())
            +printValidatedTag(child.child("JobType").val())+"</li>"
      			+printListItem("Qualifications: ", child.child("Qualifications").val())
            +printListItem("Skills: ", child.child("Skills").val())
            +printListItem("Documents required: ", child.child("DocumentsRequired").val())
            +"<li style=\"margin-top: 10px; margin-bottom: 10px;\">"
            +printValidatedValue(child.child("Description").val())+"</li>"
            +printListItem("Date and Time: ", child.child("DateTime").val())
            +printListItem("Contact No: ", child.child("Contact").val())
            +printListItem("Email: ", child.child("Email").val())
            +"</ul>"
            +"<button onclick=\"deleteJob('"+child.key+"')\" class=\"bttn delete apply\">Delete</button>"
            +"<div class=\"long-line-div\"></div>"

      		var section = document.getElementById('job_list');
          section.insertBefore(iDiv, section.firstChild);
    		});
        document.getElementById("loading").style.display = "none";
  	  });

      function deleteJob(jobKey){
        jobRef.child(jobKey).remove();
        refresh();
      }

      function markRead(key, name, email, phone, message){
        enquiryRef.child(key).set({
          Name: name,
          Email: email,
          Phone: phone,
          Message: message,
          timestamp:0,
        });
        refresh();
      }
	  
	  function deletePost(key){
        enquiryRef.child(key).remove();
        refresh();
      }


      function renderReadButton(timestamp, key, name, email, phone, message){
        if(timestamp==0){
          return "";
        }else{
          return "<button id=\"mark_read\" onclick=\"markRead('"+key+"','"+name+"','"+email+"','"+phone+"','"+message+"')\" class=\"bttn read apply\">Mark Read</button>";
        }
      }

      function printListItem(heading, content){
        if(content!=""){
          return "<li><text class=\"sub-heading\">"+heading+"</text>"+content+"</li>";
        }else{
          return "";
        }
      }

      function printValidatedTag(tag){
        if(tag!=""){
          return "<div class=\"line-div\"></div>"+tag;
        }else{
          return "";
        }
      }

      function printValidatedValue(val){
        if(val!=""){
          return val;
        }else {
          return "";
        }
      }

      function getNumberOfOpenings(openings){
        if(openings!=""){
          return "<div class=\"line-div\"></div>Openings: "+openings;
        }else {
          return "";
        }
      }

      function guid() {
        function s4() {
          return Math.floor((1 + Math.random()) * 0x10000)
            .toString(16)
            .substring(1);
        }
        return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
      }

      function askPassword() {
        var testV = 1;
        var pass1 = prompt('Authentication Required - Enter Password');
        while (testV < 3) {
        if (!pass1)
        history.go(-1);
        if (pass1 == "Godoflyf@1991") {
        alert('Access Granted - Password Correct!');
        break;
        }
        testV+=1;
        var pass1 =
        prompt('Access Denied - Password Incorrect!');
        }
        if (pass1.toLowerCase()!="password" & testV ==3)
        history.go(-1);
        return " ";
      }

      function refresh(){
        var url = new URL(window.location.href);
        var data = url.searchParams.get("data");
        if(data!="updated"){
          window.location.href = window.location.href + "?data=updated";
        }else{
          location.reload();
        }
      }

  	</script>

    </body>
</html>
